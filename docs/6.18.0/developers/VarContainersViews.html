<!-- HTML header for doxygen 1.8.20-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Dakota Developers Manual" />
<meta name="keywords" content="optimization, uncertainty quantification, model calibration, parameter estimation, sensitivity analysis, parallel computing, developers manual" />
<meta name="sandia.approval_type" content="formal" />
<meta name="sandia.approved" content="2010-2185" />
<link rev="owns" title="Brian M. Adams" href="mailto:briadam@sandia.gov" />
<meta name="Author" content="Brian M. Adams" />
<title>Dakota: Working with Variable Containers and Views</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DAKOTA_Arrow_Name_77x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Dakota
   &#160;<span id="projectnumber">Version</span>
   </div>
   <div id="projectbrief">Explore and Predict with Confidence</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Working with Variable Containers and Views </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<b>Working with Variable Containers and Views Table of Contents</b>
<ul>
<li> <a href="VarContainersViews.html#VarStorage">Storage in Variables</a> 
<li> <a href="VarContainersViews.html#SharedVarStorage">Storage in SharedVariablesData</a>
<li> <a href="VarContainersViews.html#VarActiveInactive">Active and inactive views</a> 

</ul>
</p>
<p>Variable views control the subset of variable types that are active and inactive within a particular iterative study. For design optimization and uncertainty quantification (UQ), for example, the active variables view consists of design or uncertain types, respectively, and any other variable types are carried along invisible to the iterative algorithm being employed. For parameter studies and design of experiments, however, a variable subset view is not imposed and all variables are active. Selected UQ methods can also be toggled into an "All" view using the <code>active</code> <code>all</code> variables input specification. When not in an All view, finer gradations within the uncertain variable sets are also relevant: probabilistic methods (reliability, stochastic expansion) view aleatory uncertain variables as active, nonprobabilistic methods (interval, evidence) view epistemic uncertain variables as active, and a few UQ methods (sampling) view both as active. In a more advanced <a class="el" href="classDakota_1_1NestedModel.html" title="Derived model class which performs a complete sub-iterator execution within every evaluation of the m...">NestedModel</a> use case such as optimization under uncertainty, design variables are active in the outer optimization context and the uncertain variables are active in the inner UQ context, with an additional requirement on the inner UQ level to return derivatives with respect to its "inactive" variables (i.e., the design variables) for use in the outer optimization loop.</p>
<p>For efficiency, contiguous arrays of data store variable information for each of the domain types (continuous, discrete integer, and discrete real), but active and inactive views into them permit selecting subsets in a given context. This management is encapsulated into the <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> and <a class="el" href="classDakota_1_1SharedVariablesData.html" title="Container class encapsulating variables data that can be shared among a set of Variables instances.">SharedVariablesData</a> classes. This page clarifies concepts of relaxed (formerly merged) vs. mixed, fine-grained vs. aggregated types, domain types, and views into contiguous arrays.</p>
<p>We begin with an overview of the storage and management concept, for which the following two sections describe the storage of variable values and meta-data about their organization, used in part to manage views. They are intended to communicate rationale to maintainers of <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> and <a class="el" href="classDakota_1_1SharedVariablesData.html" title="Container class encapsulating variables data that can be shared among a set of Variables instances.">SharedVariablesData</a> classes. The final section provides a discussion of active and inactive views.</p>
<h1><a class="anchor" id="VarStorage"></a>
Storage in Variables</h1>
<p>As described in the <a class="el" href="index.html#DevVariables">Main Page Variables</a>, a <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> object manages variable types (design, aleatory uncertain, epistemic uncertain, and state) and domain types (continuous, discrete integer, and discrete real) and supports different approaches to either distinguishing among these types or aggregating them. Two techniques are used in cooperation to accomplish this management: (1) class specialization (<a class="el" href="classDakota_1_1RelaxedVariables.html" title="Derived class within the Variables hierarchy which employs the relaxation of discrete variables.">RelaxedVariables</a> or <a class="el" href="classDakota_1_1MixedVariables.html" title="Derived class within the Variables hierarchy which separates continuous and discrete variables (no do...">MixedVariables</a>) and (2) views into contiguous variable arrays. The latter technique is used whenever it can satisfy the requirement, with fallback to class specialization when it cannot. In particular, aggregation or separation of variable types can be accomplished with views, but for aggregation or separation of variable domains, we must resort to class specialization in order to relax discrete domain types. In this class specialization, a <a class="el" href="classDakota_1_1RelaxedVariables.html" title="Derived class within the Variables hierarchy which employs the relaxation of discrete variables.">RelaxedVariables</a> object combines continuous and discrete types (relaxing integers to reals) whereas a <a class="el" href="classDakota_1_1MixedVariables.html" title="Derived class within the Variables hierarchy which separates continuous and discrete variables (no do...">MixedVariables</a> object maintains the integer/real distinction throughout. <br  />
</p>
<p>The core data for a <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> instance is stored in a set of three continguous arrays, corresponding to the domain types: <a class="el" href="classDakota_1_1Variables.html#a00dfe03bb5457a1e7ff51a66f2406500">allContinuousVars</a>, <a class="el" href="classDakota_1_1Variables.html#a02375b9873c13e77715f311d585d7193">allDiscreteIntVars</a>, and <a class="el" href="classDakota_1_1Variables.html#a9623352f2791142a00475c31989c5142">allDiscreteRealVars</a>, unique to each <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> instance.</p>
<p>Within the core variable data arrays, data corresponding to different aggregated variable types are stored in sequence for each domain type: </p><ul>
<li>
continuous: [design, aleatory uncertain, epistemic uncertain, state] </li>
<li>
discrete integer: [design, aleatory uncertain, (epistemic uncertain), state] </li>
<li>
discrete real: [design, aleatory uncertain, (epistemic uncertain), state] </li>
</ul>
<p>Note there are currently no epistemic discrete variables. This domain type ordering (continuous, discrete integer, discrete real) and aggregated variable type ordering (design, aleatory uncertain, epistemic uncertain, state) is preserved whenever distinct types are flattened into single contiguous arrays. Note that the aleatory and epistemic uncertain variables contain sub-types for different distributions (e.g., normal, uniform, histogram, poisson), and discrete integer types include both integer ranges and integer set sub-types. All sub-types are ordered according to their order of appearance in dakota.input.nspec.</p>
<p>When relaxing in <a class="el" href="classDakota_1_1MixedVariables.html" title="Derived class within the Variables hierarchy which separates continuous and discrete variables (no do...">MixedVariables</a>, the <a class="el" href="classDakota_1_1Variables.html#a00dfe03bb5457a1e7ff51a66f2406500">allContinuousVars</a> will also aggregate the discrete types, such that they contain ALL design, then ALL uncertain, then ALL state variables, each in aggregated type order; the <a class="el" href="classDakota_1_1Variables.html#a02375b9873c13e77715f311d585d7193">allDiscreteIntVars</a> and <a class="el" href="classDakota_1_1Variables.html#a9623352f2791142a00475c31989c5142">allDiscreteRealVars</a> arrays are empty.</p>
<h1><a class="anchor" id="SharedVarStorage"></a>
Storage in SharedVariablesData</h1>
<p>Each <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> instance contains a reference-counted <a class="el" href="classDakota_1_1SharedVariablesData.html" title="Container class encapsulating variables data that can be shared among a set of Variables instances.">SharedVariablesData</a> object that stores information on the variables configuration. This configuration data includes counts, types, IDs, and labels, which are often the same across many <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> instances. Thus, <a class="el" href="classDakota_1_1SharedVariablesData.html" title="Container class encapsulating variables data that can be shared among a set of Variables instances.">SharedVariablesData</a> is intended to reduce the memory footprint by allowing the sharing of a single copy of redundant information among different <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> instances. <br  />
</p>
<p>One of the purposes of this shared information is to support mappings between variable types, IDs, and indices into the storage arrays. Variable "types" refer to the fine-grained variable types a user would specify in an input file, as enumerated in DataVariables.hpp, e.g, CONTINUOUS_DESIGN, WEIBULL_UNCERTAIN, DISCRETE_STATE_RANGE, etc. <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#abb892aac03057e9dd76ce99ec8dfd1fd">variablesComponents</a> is a map from these variable types to counts of how many are present.</p>
<p>In contrast, the <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#a0f22efa8d516dcbc9d9a8e75bacf629b">variablesCompsTotals</a> array stores total counts of each "aggregated type" (design, aleatory uncertain, epistemic uncertain, state) which might be selected to be active in a given view. Thus this array has length 12 to track the combinations of three domain type storage arrays with four possible aggregated variable types: {continuous, discrete integer, discrete real} x {design, aleatory uncertain, epistemic uncertain, state}. For example, the first entry of this array stores the number of continuous design variables, the second the number of discrete integer design (including both discrete design range and discrete design set integer types), and the last the number of discrete real state variables.</p>
<p>The arrays <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#ab51c9014c95aabda7d5649a63823cd57">allContinuousTypes</a>, <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#a7ffc81d49f965344d730c1d50c2426b6">allDiscreteIntTypes</a>, and <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#a25cace08e5372df2950e014f00bd5df5">allDiscreteRealTypes</a> are sized to match the corresponding core domain type storage arrays. They track the fine-grained variable type stored in that entry of the data array (since when relaxed, the continuous array may be storing data corresponding to discrete data).</p>
<p>Finally <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#ac046d697ecc9fa692adb396f26b60edd">allContinuousIds</a> stores the 1-based IDs of the variables stored in the allContinuousVars array, i.e., the variable number of all the problem variables considered as a single contiguous set, in aggregate type order. For relaxed (formerly merged) views, relaxedDiscreteIds stores the 1-based IDs of the variables which have been relaxed into the continuous array.</p>
<p>These counts, types, and IDs are most commonly used within the <a class="el" href="classDakota_1_1Model.html" title="Base class for the model class hierarchy.">Model</a> classes for mappings between variables objects at different levels of a model recursion. See, for example, the variable mappings in the <a class="el" href="classDakota_1_1NestedModel.html" title="Derived model class which performs a complete sub-iterator execution within every evaluation of the m...">NestedModel</a> constructor.</p>
<h1><a class="anchor" id="VarActiveInactive"></a>
Active and inactive views</h1>
<p>The pair <a class="el" href="classDakota_1_1SharedVariablesDataRep.html#a8b724e95ad08c060d04b862013b5fb56">SharedVariablesDataRep::variablesView</a> tracks the active and inactive views of the data, with values taken from the enum in DataVariables.hpp. The valid values include EMPTY and the combinations {relaxed, mixed} x {all, design, aleatory uncertain, epistemic uncertain, uncertain, state}. The ALL cases indicate aggregation of the design, aleatory uncertain, epistemic uncertain, and state types, whereas the DISTINCT cases indicate either no aggregation (design, aleatory uncertain, epistemic uncertain, state) or reduced aggregation (aleatory+epistemic uncertain). The active view is determined by the algorithm in use, managed in <a class="el" href="classDakota_1_1Variables.html#a54cf2517e85aa843fd6848d2bd4c0262">Variables::get_view()</a>. Any inactive view is set based on higher level iteration within a model recursion (e.g., a <a class="el" href="classDakota_1_1NestedModel.html" title="Derived model class which performs a complete sub-iterator execution within every evaluation of the m...">NestedModel</a>), which enables lower level iteration to return derivatives with respect to variables that are active at the higher level. In the case where there is no higher level iteration, then the inactive view will remain EMPTY. It is important to stress that "inactive" at one level corresponds to active at another, and therefore the inactive set of variables should not be interpreted as the strict complement of the active set of variables; rather, active and inactive are both subsets whose union may still be a subset of the total container (more precise terminology might involve "primary" active and "secondary" active or similar). An active complement view could potentially be supported in the future, should the need arise, although this view would require management of non-contiguous portions of the aggregated arrays.</p>
<p>Given these groupings (views), the active and inactive subsets of the <a class="el" href="classDakota_1_1Variables.html#a00dfe03bb5457a1e7ff51a66f2406500">allContinuousVars</a>, <a class="el" href="classDakota_1_1Variables.html#a02375b9873c13e77715f311d585d7193">allDiscreteIntVars</a>, and <a class="el" href="classDakota_1_1Variables.html#a9623352f2791142a00475c31989c5142">allDiscreteRealVars</a> arrays are always contiguous, permitting vector views of the underlying data using either Teuchos::View (for numerical vectors) or Boost.MultiArray (for book-keeping arrays) views.</p>
<p>When a <a class="el" href="classDakota_1_1Variables.html" title="Base class for the variables class hierarchy.">Variables</a> envelope is constructed, its letter is initialized to either a <a class="el" href="classDakota_1_1RelaxedVariables.html" title="Derived class within the Variables hierarchy which employs the relaxation of discrete variables.">RelaxedVariables</a> or <a class="el" href="classDakota_1_1MixedVariables.html" title="Derived class within the Variables hierarchy which separates continuous and discrete variables (no do...">MixedVariables</a> object depending on the active view. The derived classes size the contiguous storage arrays to accomodate all the problem variables, and then initialize active views into them, which could involve either subsets (DISTINCT active views) or views of the full arrays (ALL active views). Inactive views, on the other hand, are initialized during construction of a model recursion (e.g., a call to <a class="el" href="classDakota_1_1Model.html#a630082a5c1222528ddc046ce0ce6755f" title="update the Model&#39;s inactive view based on a higher level context">Model::inactive_view()</a> in the <a class="el" href="classDakota_1_1NestedModel.html" title="Derived model class which performs a complete sub-iterator execution within every evaluation of the m...">NestedModel</a> constructor). Thus, active variable subsets are always available but inactive variable subsets will be EMPTY prior to them being initialized within a <a class="el" href="classDakota_1_1Model.html" title="Base class for the model class hierarchy.">Model</a> recursion. <br  />
</p>
<p>Accessors for continuous variables include: </p><ul>
<li>
continuous_variables(): returns the active view which might return all (ALL views) or a subset (DISTINCT views) such as design, uncertain, only aleatory uncertain, etc. </li>
<li>
inactive_continuous_variables(): returns the inactive view which which is either a subset or empty </li>
<li>
all_continuous_variables(): returns the full vector <a class="el" href="classDakota_1_1Variables.html#a00dfe03bb5457a1e7ff51a66f2406500">allContinuousVars</a> </li>
</ul>
<p>and this pattern is followed for active/inactive/all access to discrete_int_variables() and discrete_real_variables() as well as for labels, IDs, and types in <a class="el" href="classDakota_1_1SharedVariablesData.html" title="Container class encapsulating variables data that can be shared among a set of Variables instances.">SharedVariablesData</a> and variable bounds in <a class="el" href="classDakota_1_1Constraints.html" title="Base class for the variable constraints class hierarchy.">Constraints</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
