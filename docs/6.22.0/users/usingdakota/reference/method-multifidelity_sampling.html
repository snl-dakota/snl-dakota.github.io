<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>multifidelity_sampling &mdash; dakota  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/dakota_theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/sandiaheaderlite.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="seed_sequence" href="method-multifidelity_sampling-seed_sequence.html" />
    <link rel="prev" title="model_pointer" href="method-multilevel_sampling-model_pointer.html" /> 
  
  <meta name="sandia.approval_type" content="formal"/>
  <meta property="sandia.approved" content="SAND2025-05563O"/>
  <meta name="description" content="The Dakota project delivers both state-of-the-art research and robust, usable software for optimization and UQ."/>
  <meta name="keywords" content="Dakota, optimization, UQ, uncertainty quantification, parametric analysis, design exploration, model calibration, risk analysis"/>
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> dakota
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../setupdakota.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../usingdakota.html">Using Dakota</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction/aboutdakota.html">About Dakota</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/helloworld.html">Dakota Beginner’s Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/couplingtosimulations.html">Coupling Dakota to a Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inputfile.html">Dakota Input File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running.html">Running Dakota</a></li>
<li class="toctree-l2"><a class="reference internal" href="../output.html">Dakota Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../studytypes.html">Study Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics.html">Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced.html">Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory.html">Dakota Theory</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../reference.html">Keyword Reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="environment.html">environment</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="method.html">method</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="method-id_method.html">id_method</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-output.html">output</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-final_solutions.html">final_solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-hybrid.html">hybrid</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multi_start.html">multi_start</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-pareto_set.html">pareto_set</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-branch_and_bound.html">branch_and_bound</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-surrogate_based_local.html">surrogate_based_local</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-surrogate_based_global.html">surrogate_based_global</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dot_frcg.html">dot_frcg</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dot_mmfd.html">dot_mmfd</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dot_bfgs.html">dot_bfgs</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dot_slp.html">dot_slp</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dot_sqp.html">dot_sqp</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-conmin_frcg.html">conmin_frcg</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-conmin_mfd.html">conmin_mfd</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dl_solver.html">dl_solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-npsol_sqp.html">npsol_sqp</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-nlssol_sqp.html">nlssol_sqp</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-nlpql_sqp.html">nlpql_sqp</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-optpp_cg.html">optpp_cg</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-optpp_q_newton.html">optpp_q_newton</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-optpp_fd_newton.html">optpp_fd_newton</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-optpp_g_newton.html">optpp_g_newton</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-optpp_newton.html">optpp_newton</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-optpp_pds.html">optpp_pds</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-demo_tpl.html">demo_tpl</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-rol.html">rol</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-asynch_pattern_search.html">asynch_pattern_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-mesh_adaptive_search.html">mesh_adaptive_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-nowpac.html">nowpac</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-snowpac.html">snowpac</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-moga.html">moga</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-soga.html">soga</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-coliny_pattern_search.html">coliny_pattern_search</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-coliny_solis_wets.html">coliny_solis_wets</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-coliny_cobyla.html">coliny_cobyla</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-coliny_direct.html">coliny_direct</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-coliny_ea.html">coliny_ea</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-coliny_beta.html">coliny_beta</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-nl2sol.html">nl2sol</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-nonlinear_cg.html">nonlinear_cg</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-ncsu_direct.html">ncsu_direct</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-genie_opt_darts.html">genie_opt_darts</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-genie_direct.html">genie_direct</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-efficient_global.html">efficient_global</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-surrogate_based_uq.html">surrogate_based_uq</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-function_train.html">function_train</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multifidelity_function_train.html">multifidelity_function_train</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multilevel_function_train.html">multilevel_function_train</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-polynomial_chaos.html">polynomial_chaos</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multifidelity_polynomial_chaos.html">multifidelity_polynomial_chaos</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multilevel_polynomial_chaos.html">multilevel_polynomial_chaos</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-stoch_collocation.html">stoch_collocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multifidelity_stoch_collocation.html">multifidelity_stoch_collocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-sampling.html">sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multilevel_sampling.html">multilevel_sampling</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">multifidelity_sampling</a><ul>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-seed_sequence.html">seed_sequence</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-fixed_seed.html">fixed_seed</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-pilot_samples.html">pilot_samples</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-solution_mode.html">solution_mode</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-numerical_solve.html">numerical_solve</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-search_model_graphs.html">search_model_graphs</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-sample_type.html">sample_type</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-export_sample_sequence.html">export_sample_sequence</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-convergence_tolerance.html">convergence_tolerance</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-max_iterations.html">max_iterations</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-max_function_evaluations.html">max_function_evaluations</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-rng.html">rng</a></li>
<li class="toctree-l5"><a class="reference internal" href="method-multifidelity_sampling-model_pointer.html">model_pointer</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="method-multilevel_multifidelity_sampling.html">multilevel_multifidelity_sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-approximate_control_variate.html">approximate_control_variate</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multilevel_blue.html">multilevel_blue</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-importance_sampling.html">importance_sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-gpais.html">gpais</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-adaptive_sampling.html">adaptive_sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-pof_darts.html">pof_darts</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-rkd_darts.html">rkd_darts</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-global_evidence.html">global_evidence</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-global_interval_est.html">global_interval_est</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-bayes_calibration.html">bayes_calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-dace.html">dace</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-fsu_cvt.html">fsu_cvt</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-psuade_moat.html">psuade_moat</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-local_evidence.html">local_evidence</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-local_interval_est.html">local_interval_est</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-local_reliability.html">local_reliability</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-global_reliability.html">global_reliability</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-fsu_quasi_mc.html">fsu_quasi_mc</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-vector_parameter_study.html">vector_parameter_study</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-list_parameter_study.html">list_parameter_study</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-centered_parameter_study.html">centered_parameter_study</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-multidim_parameter_study.html">multidim_parameter_study</a></li>
<li class="toctree-l4"><a class="reference internal" href="method-richardson_extrap.html">richardson_extrap</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="variables.html">variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="interface.html">interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="responses.html">responses</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usingdakotagui/usingdakotagui.html">Using Dakota GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../externaltools/externaltools.html">Using External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compiling/compiling.html">Compiling Dakota</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developingdakota/developingdakota.html">Developing Dakota</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/misc.html">Miscellaneous</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">dakota</a>
      </nav>

	  <!-- SNL Lite header -->
	  <div class="snlheader-subsite--wrapper-default">
		<snlheader class="snlheader-subsite" role="snlbanner">
		  <div class="wrapper">
			<a href="https://www.sandia.gov/index.html">
			  <div class="logo-transparent"><p class="logo">Sandia National Laboratories</p></div>
			</a>
			<div class="nav-top">
			  <a class="visuallyhidden" name="mainnav"></a>
			  <div aria-label="main navigation" class="core-nav-transparent core-nav-transparent--visible" role="navigation">
				<ul role="navigation" class="secondary-links">
				  <li id="search-text-link">
					<a aria-label="Search" href="https://www.sandia.gov/search/">Search Sandia.gov</a>
				  </li>
				  <li id="directory-text-link">
					<a href="https://www.sandia.gov/directory.html" aria-expanded="false" aria-label="Site Directory">All Sandia Websites</a>
				  </li>
				</ul>
			  </div>
			</div>
		  </div> 
		</snlheader>
	  </div>	  

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../usingdakota.html">Using Dakota</a></li>
          <li class="breadcrumb-item"><a href="../reference.html">Keyword Reference</a></li>
          <li class="breadcrumb-item"><a href="method.html">method</a></li>
      <li class="breadcrumb-item active">multifidelity_sampling</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/usingdakota/reference/method-multifidelity_sampling.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="multifidelity-sampling">
<span id="method-multifidelity-sampling"></span><h1>multifidelity_sampling<a class="headerlink" href="#multifidelity-sampling" title="Link to this heading"></a></h1>
<p>Multifidelity Monte Carlo sampling method for UQ</p>
<div class="toctree-wrapper compound">
</div>
<p><strong>Specification</strong></p>
<ul class="simple">
<li><p><em>Alias:</em> multifidelity_mc mfmc</p></li>
<li><p><em>Arguments:</em> None</p></li>
</ul>
<p><strong>Child Keywords:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Required/Optional</p></th>
<th class="head"><p>Description of
Group</p></th>
<th class="head"><p>Dakota Keyword</p></th>
<th class="head"><p>Dakota Keyword Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-seed_sequence.html">seed_sequence</a></p></td>
<td><p>Sequence of seed values for multi-stage
random sampling</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-fixed_seed.html">fixed_seed</a></p></td>
<td><p>Reuses the same seed value for multiple
random sampling sets</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-pilot_samples.html">pilot_samples</a></p></td>
<td><p>Initial set of samples for
multilevel/multifidelity sampling methods.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-solution_mode.html">solution_mode</a></p></td>
<td><p>Solution mode for multilevel/multifidelity
methods</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-numerical_solve.html">numerical_solve</a></p></td>
<td><p>Specify the situations where numerical
optimization is used for MFMC sample
allocation</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-search_model_graphs.html">search_model_graphs</a></p></td>
<td><p>Perform a search over admissible model
relationships for a given model ensemble</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-sample_type.html">sample_type</a></p></td>
<td><p>Selection of sampling strategy</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-export_sample_sequence.html">export_sample_sequence</a></p></td>
<td><p>Enable export of multilevel/multifidelity
sample sequences to individual files</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-convergence_tolerance.html">convergence_tolerance</a></p></td>
<td><p>Stopping criterion based on relative error
reduction</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-max_iterations.html">max_iterations</a></p></td>
<td><p>Number of iterations allowed for optimizers
and adaptive UQ methods</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-max_function_evaluations.html">max_function_evaluations</a></p></td>
<td><p>Stopping criterion based on maximum function
evaluations</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-rng.html">rng</a></p></td>
<td><p>Selection of a random number generator</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>Optional</p></td>
<td><p><a class="reference external" href="method-multifidelity_sampling-model_pointer.html">model_pointer</a></p></td>
<td><p>Identifier for model block to be used by a
method</p></td>
</tr>
</tbody>
</table>
<p><strong>Description</strong></p>
<p>An adaptive sampling method that utilizes multifidelity
relationships in order to improve efficiency through variance reduction.</p>
<p>Multifidelity sampling is a recursive sampling scheme for which model
ordering is important.  In the case of an ensemble surrogate model
with more than two model instances (either in terms of model forms or
resolutions or both), the multi-model approach of <span id="id14">[<a class="reference internal" href="../../misc/bibliography.html#id214" title="Benjamin Peherstorfer, Karen Willcox, and Max Gunzburger. Optimal model management for multifidelity monte carlo estimation. SIAM Journal on Scientific Computing, 38(5):A3163–A3194, 2016.">PWG16</a>]</span>
is supported for which all model instances can be integrated into the
scheme.  In the special case of two model instances, this collapses to
the approach of <span id="id15">[<a class="reference internal" href="../../misc/bibliography.html#id324" title="L. W. T. Ng. and K. E. Willcox. Multifidelity approaches for optimization under uncertainty. International Journal for numerical methods in Engineering, 100(10):746–772, 2014.">NgW14</a>]</span>.  The approach can be used with
a model form sequence, a resolution level sequence, or a combination of
both (all specified form/resolution combinations will be enumerated).</p>
<p><em>Control Variate Monte Carlo</em></p>
<p>In the case of two model instances (low fidelity denoted as LF and
high fidelity denoted as HF), we employ a control variate approach as
described in <span id="id16">[<a class="reference internal" href="../../misc/bibliography.html#id324" title="L. W. T. Ng. and K. E. Willcox. Multifidelity approaches for optimization under uncertainty. International Journal for numerical methods in Engineering, 100(10):746–772, 2014.">NgW14</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[\hat{Q}_{HF}^{CV} = \hat{Q}_{HF}^{MC}
- \beta (\hat{Q}_{LF}^{MC} - \mathbb{E}[Q_{LF}])\]</div>
<p>As opposed to the traditional control variate approach, we do not know
<span class="math notranslate nohighlight">\(\mathbb{E}[Q_{LF}]\)</span>  precisely, but rather we estimate it more
accurately than <span class="math notranslate nohighlight">\(\hat{Q}_{LF}^{MC}\)</span>  based on a sampling increment
applied to the LF model.  This sampling increment is based on
a total cost minimization procedure that incorporates the relative LF
and HF costs and the observed Pearson correlation coefficient
<span class="math notranslate nohighlight">\(\rho_{LH}\)</span>  between <span class="math notranslate nohighlight">\(Q_{LF}\)</span>  and <span class="math notranslate nohighlight">\(Q_{HF}\)</span> .  The
coefficient <span class="math notranslate nohighlight">\(\beta\)</span> is then determined from the observed LF-HF
covariance and LF variance.</p>
<p><em>Multifidelity Monte Carlo</em></p>
<p>This approach can be extended to a sequence of low-fidelity
approximations using a recusive sampling approach as in
<span id="id17">[<a class="reference internal" href="../../misc/bibliography.html#id214" title="Benjamin Peherstorfer, Karen Willcox, and Max Gunzburger. Optimal model management for multifidelity monte carlo estimation. SIAM Journal on Scientific Computing, 38(5):A3163–A3194, 2016.">PWG16</a>]</span>.</p>
<div class="math notranslate nohighlight">
\[\hat{Q}_{HF}^{CV} = \hat{Q}_{HF}^{MC}
- \sum_{i=1}^M \beta_i (\hat{Q}_{LF_i}^{MC} - \mathbb{E}[Q_{LF_i}])\]</div>
<p>In this case, the variance in the estimate of the <span class="math notranslate nohighlight">\(i^{th}\)</span> control
mean is reduced by the <span class="math notranslate nohighlight">\((i+1)^{th}\)</span> control variate, such that the
variance reduction is limited by the case of an exact estimate of the
first control mean (referred to as OCV-1 in <span id="id18">[<a class="reference internal" href="../../misc/bibliography.html#id127" title="Alex A. Gorodetsky, Gianluca Geraci, Michael S. Eldred, and John D. Jakeman. A generalized approximate control variate framework for multifidelity uncertainty quantification. Journal of Computational Physics, 408:109257, 2020. URL: https://www.sciencedirect.com/science/article/pii/S0021999120300310, doi:https://doi.org/10.1016/j.jcp.2020.109257.">GGEJ20</a>]</span>).</p>
<p><em>Model Selection</em></p>
<p>Similar to weighted MLMC (see
<code class="docutils literal notranslate"><a class="reference external" href="../../usingdakota/reference/method-multilevel_sampling-weighted.html"><span class="pre">weighted</span></a></code>), MFMC is a special case
of generalized ACV (<span id="id19">[<a class="reference internal" href="../../misc/bibliography.html#id128" title="G.F. Bomarito, P.E. Leser, J.E. Warner, and W.P. Leser. On the optimization of approximate control variates with parametrically defined estimators. Journal of Computational Physics, 451:110882, 2022. doi:https://doi.org/10.1016/j.jcp.2021.110882.">BLWL22</a>]</span>) using the ACV-MF sampling
scheme in combination with a hierarchical DAG (each approximation node
points to the next approximation of higher fidelity, ending with the
truth model at the root node). As such, the MFMC approach can be
promoted to the generalized ACV solver in order to gain access to its
model selection capabilities.  Activating the <code class="docutils literal notranslate"><span class="pre">model_selection</span></code>
option results in a set of numerical solutions that will enumerate
model combinations for a fixed hierarchical DAG.</p>
<p><em>Default Behavior</em></p>
<p>The <code class="docutils literal notranslate"><span class="pre">multifidelity_sampling</span></code> method employs a number of important default settings:</p>
<ul class="simple">
<li><p>The DAG defining control variate pairings is a “hierarchical” DAG where each approximation node points to the next approximation of higher fidelity, ending with the truth model at the root node.  For other DAG options, refer to the approximate control variate method (peer DAG by default) and it’s option to <code class="docutils literal notranslate"><span class="pre">search_model_graphs</span></code> (enumerates all or some subset of the admissible DAGs).</p></li>
<li><p>If the model QoI are well-ordered, then the analytic solution from <span id="id20">[<a class="reference internal" href="../../misc/bibliography.html#id214" title="Benjamin Peherstorfer, Karen Willcox, and Max Gunzburger. Optimal model management for multifidelity monte carlo estimation. SIAM Journal on Scientific Computing, 38(5):A3163–A3194, 2016.">PWG16</a>]</span> will be used.  If a numerical solution is instead used, whether due to an override specification or due to detection of model misordering, the numerical solver will be <code class="docutils literal notranslate"><span class="pre">global_local</span></code> by default, starting with the DIRECT global solver and proceeding to available local solvers (SQP and NIP) in competition.  The numerical solution reorders models on the fly in order to enforce the required ordering constraints for computing the MFMC estimator variance.</p></li>
<li><p>Solution mode will be <code class="docutils literal notranslate"><span class="pre">online_pilot</span></code>, an approach which iterates toward a set of shared samples whose size is consistent with the optimal allocation</p></li>
<li><p>Monte Carlo sample sets are used by default and are most consistent with the underlying theory, but this default can be overridden to use Latin hypercube sample sets using <code class="docutils literal notranslate"><span class="pre">sample_type</span></code> <code class="docutils literal notranslate"><span class="pre">lhs</span></code>.  Allocations remain governed by Monte Carlo variance for all cases.</p></li>
</ul>
<p><em>Expected Output</em></p>
<p>The <code class="docutils literal notranslate"><span class="pre">multifidelity_sampling</span></code> method reports estimates of the first four
moments and a summary of the evaluations performed for each model
fidelity and discretization level.  The method does not support any
level mappings (response, probability, reliability, generalized
reliability) at this time.</p>
<p><em>Expected HDF5 Output</em></p>
<p>If Dakota was built with HDF5 support and run with the
<code class="docutils literal notranslate"><a class="reference external" href="../../usingdakota/reference/environment-results_output-hdf5.html"><span class="pre">hdf5</span></a></code> keyword, this method
writes the following results to HDF5:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../output/hdf/organizationofresults.html#hdf5-results-sampling-moments"><span class="std std-ref">Sampling Moments</span></a> (moments only, not confidence intervals)</p></li>
</ul>
<p>In addition, the execution group has the attribute <code class="docutils literal notranslate"><span class="pre">equiv_hf_evals</span></code>, which
records the equivalent number of high-fidelity evaluations.</p>
<p><em>Usage Tips</em></p>
<p>The <code class="docutils literal notranslate"><span class="pre">multifidelity_sampling</span></code> method is used in combination with an
ensemble model specification for a model form sequence, a
discretization level sequence, or both.  For a model form sequence,
each model must provide a scalar <code class="docutils literal notranslate"><span class="pre">solution_level_cost</span></code>.  For a
discretization level sequence, it is necessary to identify the
variable string descriptor that controls the resolution levels using
<code class="docutils literal notranslate"><span class="pre">solution_level_control</span></code> as well as the associated array of relative
costs using <code class="docutils literal notranslate"><span class="pre">solution_level_cost</span></code>.  An alternative to prescribing
the cost profile is estimating it on the fly using cost metadata that
is returned from the different simulation instances.</p>
<p><strong>Examples</strong></p>
<p>We provide an example of a multifidelity Monte Carlo study using an
ensemble model specification employing multiple approximations.</p>
<p>The following method block:</p>
<div class="highlight-dakota notranslate"><div class="highlight"><pre><span></span><span class="k">method</span>,
 model_pointer = &#39;NONHIER&#39;
 multifidelity_sampling
   pilot_samples = 20 seed = 1237
   max_iterations = 10
   convergence_tolerance = .001
</pre></div>
</div>
<p>specifies MFMC in combination with the model identified by the
NONHIER pointer.</p>
<p>This NONHIER model specification provides a truth model and a set of
unordered approximation models, each with a single (or default)
discretization level:</p>
<div class="highlight-dakota notranslate"><div class="highlight"><pre><span></span><span class="k">model</span>,
 id_model = &#39;NONHIER&#39;
 surrogate ensemble
   truth_model = &#39;HF&#39;
   unordered_model_fidelities = &#39;LF1&#39; &#39;LF2&#39;

<span class="k">model</span>,
 id_model = &#39;LF1&#39;
 interface_pointer = &#39;LF1_INT&#39;
 simulation
   solution_level_cost = 0.01

<span class="k">model</span>,
 id_model = &#39;LF2&#39;
 interface_pointer = &#39;LF2_INT&#39;
 simulation
   solution_level_cost = 0.1

<span class="k">model</span>,
 id_model = &#39;HF&#39;
 interface_pointer = &#39;HF_INT&#39;
 simulation
   solution_level_cost = 1.
</pre></div>
</div>
<p>Refer to <code class="docutils literal notranslate"><span class="pre">dakota/test/dakota_uq_*_cvmc</span></code>.in and
<code class="docutils literal notranslate"><span class="pre">dakota/test/dakota_uq_*_mfmc</span></code>.in in the source distribution
for additional examples.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="method-multilevel_sampling-model_pointer.html" class="btn btn-neutral float-left" title="model_pointer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="method-multifidelity_sampling-seed_sequence.html" class="btn btn-neutral float-right" title="seed_sequence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <!--
  <div role="contentinfo">
    <p>&#169; Copyright 2024, Sandia National Laboratories.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
  --> 

</footer>
        </div>
      </div>
	  
	  <div style="background-color: #0f0f0f;color:#fafafa;padding:20px">
	    <div>
		  <h2><em>Exceptional service in the national interest</em></h2>
		</div>
		<p>© 2023 National Technology and Engineering Solutions of Sandia, LLC. | <a href="https://www.sandia.gov/contact_us/index.html">Questions &amp; Comments</a> | <a href="https://www.sandia.gov/general/privacy-security/index.html">Privacy &amp; Security</a></p>
		<p><a href="http://energy.gov" rel="noopener noreferrer" target="_blank"><img alt="U.S. Department of Energy" longdesc="https://energy.gov" src="https://www.sandia.gov/_common/images/doe_logo_white.png" style="height:37px; width:140px"></a> <a href="http://nnsa.energy.gov/" rel="noopener noreferrer" target="_blank"> <img alt="National Nuclear Security Administration" longdesc="http://nnsa.gov" src="https://www.sandia.gov/_common/images/nnsa_logo_white.png" style="height:37px; width:116px"></a></p>
		<p><a href="https://www.sandia.gov">Sandia National Laboratories</a> is a multimission laboratory managed and operated by National Technology and Engineering Solutions of Sandia, LLC., a wholly owned subsidiary of Honeywell International, Inc., for the U.S. Department of Energy’s National Nuclear Security Administration under contract DE-NA-0003525.</p>
	  </div>	  	  
	  
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>